!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);o(1),o(2),o(3);let n=jQuery;document.body.addEventListener("touchstart",()=>{document.querySelector("html").classList.add("touch-device")}),n("#edit-submitted-customer-tel").mask("(999) 999 99 99");const r=document.querySelectorAll(".main-menu__link");for(const e of r)e.classList.contains("active")&&(delete e.href,e.parentElement.classList.add("active"));const i=document.querySelectorAll('.local-menu [href*="#"]');for(let e of i)e.addEventListener("click",(function(t){t.preventDefault();const o=e.getAttribute("href");document.querySelector(o).scrollIntoView({behavior:"smooth",block:"start"})}))},function(e,t){let o=!0,n="";try{n=localStorage.getItem("bp_notice_date")}catch(e){o=!1}const r=document.querySelector(".notice"),i=r.querySelector(".notice__section").dataset.date,a=e=>{e.preventDefault(),"Escape"!==e.key&&"Enter"!==e.key||l(r)},l=e=>{e.hidden=!0,document.removeEventListener("keydown",a)};o&&(n===i?l(r):(r.hidden=!1,document.addEventListener("keydown",a),localStorage.setItem("bp_notice_date",i))),r.addEventListener("click",e=>{e.preventDefault(),l(r)})},function(e,t){var o;(o=jQuery)("tbody td, thead th:not([colspan])").hover((function(){const e=o(this);if(e.closest("table").hasClass("table--poor"))return;const t=e.closest("table").children("tbody").children().first().children("th").size(),n=t=>{const n=e.closest("table").children(t).children(),r=new Array(n.size()).fill(0);return n.each((e,t)=>{o(t).children().each((t,n)=>{const i=+o(n).attr("rowspan"),a=+o(n).attr("colspan");for(let t=e+1;t<e+i;t++)r[t]++,a>1&&(r[t]+=a-1)})}),r},r=t=>{let o=e.index()-t;return e.closest("thead").size()>0?o+=i[e.parent().index()]:o+=a[e.parent().index()],o},i=n("thead"),a=n("tbody"),l=a.map(r),c=i.map(r);l.forEach((function(n,r){n>t-1-a[r]&&o(o(e.closest("table").children("tbody").children()[r]).children()[n]).toggleClass("highlighted")})),c.forEach((function(n,r){n>t-1-i[r]&&o(o(e.closest("table").children("thead").children()[r]).children("th:not([colspan])")[n]).toggleClass("highlighted")}))}))},function(e,t){let o=jQuery;const n=document.querySelector(".webform-client-form-74");let r={};function i(){document.querySelector("#edit-submitted-parameters-amount").innerHTML=function(e){let t='<optgroup label="Цифровая печать">',o=Object.entries(e[1].digital);for(let e of o)t+=`<option value="${e[0]}" data-metod="digital">${e[0]}</option>`;t+='<optgroup label="Офсетная печать">',o=Object.entries(e[1].offset);for(let e of o)t+=`<option value="${e[0]}" data-metod="offset">${e[0]}</option>`;return t}(r.vizPrices),document.querySelector("#edit-submitted-parameters-carton").innerHTML=function(e){let t="",o=1,n=Object.entries(e);for(let e of n.values())t+=`<option value="${o}" data-carton="${e[0]}">${e[1].name}</option>`,o++;return t}(r.cartonPrices)}function a(){let{designPrice:e,shippingPrice:t,vizPrices:n,cartonPrices:i}=r;const a=o("#edit-submitted-option :radio:checked").val(),l=o("#edit-submitted-parameters-amount option:selected").data("metod"),c=o("#edit-submitted-parameters-amount option:selected").text(),d=o("#edit-submitted-parameters-carton option:selected").data("carton"),s=o("#edit-submitted-parameters-carton option:selected").text(),u=o("#edit-submitted-parameters-sides :radio:checked").val(),m=o("#edit-submitted-parameters-rounded :checkbox").prop("checked"),f=o("#edit-submitted-order-get-option :radio:checked").val(),p=o(".webform-component--parameters--amount .description");p.text("* офсетная печать одного макета"),o("#edit-submitted-parameters-amount .description").text();let b=n[u][l][c];if("digital"==l){const e=document.querySelector("#edit-submitted-parameters-carton");for(const t of e.querySelectorAll("option"))t.disabled=!1;b+=i[d][c]-i.cristalBoard[c],m&&(b+=+c),p.text("* цифровая печать"+(+c>100?" до "+Math.round(c/100)+" разных макетов":""))}else{const e=document.querySelector("#edit-submitted-parameters-carton");e.selectedIndex=0;for(const t of e.querySelectorAll("option"))t.value>1&&(t.disabled=!0)}"design"==a&&(b+=e),"shipping"==f&&(b+=t),o(".total__price").text(b),o("#edit-submitted-summa").val(b);let h="<ul>";h+=1==u?"<li>визитки односторонние</li>":"<li>визитки двусторонние</li>",h+="digital"==l?"<li>цифровая печать</li>":"<li>офсетная печать</li>",h+="<li>"+s.toLowerCase()+"</li>",h+=m?"<li>скругление</li>":"",h+="shipping"==f?"<li>доставка</li>":"<li>самовывоз</li>",h+=`</ul>Тираж ${c} шт.`,o(".total__summary").html(h)}const l=()=>{const e=document.querySelector(".webform .form-actions .form-submit"),t=document.querySelector('[name="submitted[design][src][file][fid]"]').value>0||document.querySelector("#edit-submitted-design-information-text").textLength>0||document.querySelector("#edit-submitted-design-src-link").value.length>0,o=document.querySelector("#edit-submitted-customer-mail").validity.valid,n=document.querySelector("#edit-submitted-customer-consent-1").validity.valid;e.disabled=!(t&&o&&n);let r=`<span class="total__warning--${t}">макет</span>`;r+=` <span class="total__warning--${o}">e-mail</span>`,r+=` <span class="total__warning--${n}">согласие</span>`;const i=document.querySelector(".total__warning")||document.createElement("p");i.className="total__warning",i.innerHTML=r;document.querySelector(".total__warning-wrap").prepend(i),e.disabled?document.querySelector(".total__warning").classList.add("total__warning--invalid"):document.querySelector(".total__warning").classList.remove("total__warning--invalid")},c=()=>{document.querySelector(".webform").classList.add("webform--active");const e=document.querySelectorAll(".webform fieldset");for(const t of e)t.classList.remove("disabled"),t.disabled=!1},d=()=>{l(),a()},s=e=>{l(),e.find(e=>"form-managed-file"==e.target.className)&&f()},u=e=>{let t=new MouseEvent("mousedown");e.target.closest(".form-managed-file").querySelector(".upload-button").dispatchEvent(t)},m=e=>{const t=e.querySelector(".upload-button");t&&(t.style.display="none"),e.addEventListener("change",u)},f=()=>{const e=document.querySelectorAll(".form-managed-file");for(const t of e)m(t)};if(n){fetch("sites/belka-print.ru/themes/bs4theme/src.php",{method:"POST",body:"viz"}).then(e=>e.json()).then(e=>{r=e,i(),a()});document.querySelector(".webform-component--option").addEventListener("click",c,{once:!0}),n.addEventListener("keyup",l),n.addEventListener("change",d);new MutationObserver(s).observe(n.querySelector(".webform-component--design--src"),{childList:!0,subtree:!0}),l(),f()}}]);